<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Primitive Physics Scene</title>

		<!-- Load A-Frame first -->
		<script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
		<!-- <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script> -->

		<!-- Then load Ammo.js (physics engine) -->
		<script src="https://cdn.8thwall.com/web/aframe/ammo.wasm.js"></script>
		<!-- <script src="http://kripken.github.io/ammo.js/builds/ammo.wasm.js"></script> -->
		<!-- <script src="https://mixedreality.mozilla.org/ammo.js/builds/ammo.wasm.js"></script> -->

		<!-- Then load the A-Frame physics system -->
		<script src="https://unpkg.com/@c-frame/aframe-physics-system@4.2.2/dist/aframe-physics-system.min.js"></script>
		<!-- <script src="https://cdn.8thwall.com/web/aframe/aframe-physics-system-4.2.2.min.js"></script> -->
	</head>
	<body>
		<a-scene
			physics="driver: ammo; debug: false"
			renderer="colorManagement: true; webgl2: false">
			<a-entity
				light="type: directional; intensity: 0.8"
				position="1 4.3 2.5"></a-entity>
			<a-light type="ambient" intensity="0.5"></a-light>

			<!-- Camera + Glove Box -->
			<a-camera id="camera" position="0 1.5www 0">
				<a-box
					id="glove"
					punch-tap
					color="red"
					depth="0.5"
					height="0.5"
					width="0.5"
					ammo-body="type: kinematic"
					ammo-shape="type: box"
					position="0 -1 -1"></a-box>
			</a-camera>

			<!-- Ball (Sphere) -->
			<a-sphere
				id="soccer-ball"
				radius="0.5"
				color="white"
				position="0 2 -3"
				ammo-body="type: dynamic"
				ammo-shape="type: sphere"></a-sphere>

			<!-- Bowling Pins (Cylinders) -->
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="0 1 -7"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin1"></a-cylinder>
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="-0.5 0 -8.5"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin2"></a-cylinder>
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="0.5 0 -8.5"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin3"></a-cylinder>
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="0 0 -10"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin4"></a-cylinder>
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="-1 0 -10"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin5"></a-cylinder>
			<a-cylinder
				color="blue"
				height="1"
				radius="0.15"
				position="1 0 -10"
				ammo-body="type: dynamic"
				ammo-shape="type: cylinder"
				id="pin6"></a-cylinder>

			<!-- Ground Plane -->
			<a-plane
				rotation="-90 0 0"
				height="100"
				width="100"
				color="#000"
				position="0 0 0"
				ammo-body="type: static"
				ammo-shape="type: box"></a-plane>
		</a-scene>

		<script>
			// Simple punch animation component
			AFRAME.registerComponent("punch-tap", {
				schema: {
					yOffset: { type: "number", default: -1 },
					zOffset: { type: "number", default: -1 },
				},
				init() {
					this.punchAnimation = () => {
						this.el.removeAttribute("animation");
						this.el.setAttribute(
							"animation",
							`property: position; dur: 125; from: 0 ${this.data.yOffset} ${this.data.zOffset}; to: 0 ${this.data.yOffset} -3; dir: alternate; loop: 2; easing: easeInOutQuad`
						);
					};

					this.el.sceneEl.addEventListener("click", this.punchAnimation);
					window.addEventListener("keydown", (e) => {
						if (e.key === " ") this.punchAnimation();
					});
				},
			});
		</script>
	</body>
</html>
